---
title: "Critical Windows TCP/IP Remote Code Execution Vulnerability Vulnerability (CVE-2024-38063)"
date: 2024-08-16T01:00:00Z
image: /images/CVE-2024-38063/critical-vulnerability-windows-systems-IPv6-blog.jpg
categories: ["CVE"]
featured: true
draft: false
summary: 'CVE-2024-38063 is a critical zero-click Windows TCP/IP vulnerability that allows remote code execution, emphasizing the need for immediate patching or careful mitigation.'
---

## Introduction


On August 13, 2024, Microsoft issued an urgent warning this week about a severe vulnerability in the Windows TCP/IP stack that could allow attackers to remotely execute code on vulnerable systems without any user interaction. This zero-click vulnerability, identified as [CVE-2024-38063](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-38063), impacts all Windows systems with IPv6 enabled, which is the default setting for most users.

Discovered by [XiaoWei](https://x.com/XiaoWei___) from Kunlun Lab, the flaw is caused by an integer underflow that can be exploited to trigger buffer overflows, ultimately granting attackers complete control over compromised systems. The researcher emphasized the severity of the issue, stating that more details would not be disclosed in the short term due to the potential harm.

## Vulnerability Details
      - Severity: Critical (CVSS score: 9.8)
      -  Impact: Remote code execution
      -  Exploitability: High, with potential for rapid weaponization
      -  Affected Systems: All Windows systems with IPv6 enabled

## How the Attack Works

An unauthenticated attacker can exploit this vulnerability by sending specially crafted IPv6 packets to a vulnerable Windows system. Successful exploitation can lead to remote code execution, granting the attacker full control over the compromised system.

## Mitigations

While Microsoft has released a patch to address this vulnerability, organizations may face challenges in deploying updates promptly. In such cases, the following mitigation can be considered:
    - Disable IPv6: Disabling IPv6 can effectively protect systems from this attack. However, it's important to note that this might impact the functionality of certain Windows components.

## Disabling IPv6: A Closer Look

One way is to manipulate the Windows Registry. Running this PowerShell command will show us our current IPv6 settings:

```PowerShell
Get-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters\
```
This command displays the existing IPv6 configuration, including whether it's enabled or disabled.

![Github Traffic](/images/CVE-2024-38063/IPV6-1.png)
*IPV6 Configuration*

```ts:PowerShell
Set-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters -Name "DisabledComponents" -Value 0xFF -Type DWord
```
This command sets the DisabledComponents value to 255, effectively disabling IPv6.

![Github Traffic](/images/CVE-2024-38063/IPV6-2.png)
*Disable IPV6*

Alternatively, we can disable IPv6 protocol binding for all network adapters on the system, as X(Former Twitter) user [biffbiffbiff](https://x.com/biffbiffbiff/status/1823676176562290734) points out.

## Should You Disable IPv6?

If your organization determines that IPv6 is not necessary, then following the principle of least functionality, you should consider disabling it. However, for most users, IPv6 should remain enabled. [Microsoft advises against disabling IPv6](https://learn.microsoft.com/en-us/troubleshoot/windows-server/networking/configure-ipv6-in-windows), noting that doing so may impair certain Windows components. As they state, â€œWe do not recommend that you disable IPv6 or its components. If you do, some Windows components may not function properly.

Rather than disabling IPv6, it is advisable to address CVE-2024-38063 by applying the [patches](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2024-38063) provided by Microsoft. In cases where patching is not feasible, organizations should carefully evaluate the risks and consider disabling IPv6 on systems that cannot be patched, using the methods discussed earlier.

## Re-Enable IPv6

If you have disabled IPv6 and now wish to re-enable it, you can do so with the following PowerShell commands:
Restore the DisabledComponents registry value to its [default](https://learn.microsoft.com/en-us/troubleshoot/windows-server/networking/configure-ipv6-in-windows) setting of 0x00:

```PowerShell
Set-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters -Name "DisabledComponents" -Value 0x00 -Type DWord
```

![Github Traffic](/images/CVE-2024-38063/IPV6-3.png)
*Restore the DisabledComponents registry value*

To re-enable IPv6 on our Network Adapters, we will run the PowerShell command:

```PowerShell
Get-NetAdapter | ForEach { Enable-NetAdapterBinding -InterfaceAlias $_.Name -ComponentID ms_tcpip6 }
```
![Github Traffic](/images/CVE-2024-38063/IPV6-4.png)
*Enable IPV6*

## Recommendations

- Apply the Patch: Prioritize the installation of the official patch released by Microsoft as soon as possible.
- Monitor for Exploits: Stay vigilant for any signs of exploitation or public proof-of-concept code.
- Implement Network Segmentation: Consider network segmentation to limit the potential impact of a successful attack.
- Regularly Update Systems: Maintain up-to-date operating systems and software to address vulnerabilities promptly.

## Conclusion

CVE-2024-38063 underscores the importance of timely patch management and robust security practices. Organizations must prioritize the application of the official patch and consider additional mitigation measures to protect their systems from this critical vulnerability.

Note: This blog post is based on the information available at the time of writing. It's essential to refer to the latest updates and advisories from Microsoft and other reputable security sources for the most accurate and up-to-date information.

## References
[Windows TCP/IP Remote Code Execution Vulnerability - Microsoft Security Updates](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-38063)

[Zero-click Windows TCP/IP RCE impacts all systems with IPv6 enabled, patch now - BleepingComputer](https://www.bleepingcomputer.com/news/microsoft/zero-click-windows-tcp-ip-rce-impacts-all-systems-with-ipv6-enabled-patch-now/)

[National Vulnerability Database - CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)

> CVE-2024-38063 - "The Great Windows Oopsie".
 CVSS: 9.8 - "Because why not make it critical?"
 What's the buzz? Windows 10, 11, & Server decided to let anyone run code like they own the place. SYSTEM privileges? More like SYSTEM surprises!
